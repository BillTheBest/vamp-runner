{
  "name": "HTTP Deployment with Condition Strength",
  "description": "Deploying 2 HTTP services with route weight and condition strength.",
  "steps": [
    {
      "description": "Create 2 breeds, scale and condition.",
      "run": {
        "method": "PUT",
        "resource": "deploy1.yml",
        "await": [
          "conditions:url_beg", "archive:update"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "deploy1.yml",
        "await": [
          "conditions:url_beg", "archive:delete"
        ]
      }
    },
    {
      "description": "Deploy 1st service.",
      "run": {
        "method": "PUT",
        "resource": "deploy2.yml",
        "await": [
          "deployments:runner1", "clusters:runner", "services:runner:1", "synchronization:deployed"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "undeploy2.yml",
        "await": [
          "deployments:runner1", "clusters:runner", "services:runner:1", "synchronization:undeployed"
        ]
      }
    },
    {
      "description": "Deploy 2nd service.",
      "run": {
        "method": "PUT",
        "resource": "deploy3.yml",
        "await": [
          "deployments:runner2", "clusters:runner", "services:runner:2", "synchronization:deployed"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "undeploy3.yml",
        "await": [
          "deployments:runner2", "clusters:runner", "services:runner:2", "synchronization:undeployed"
        ]
      }
    },
    {
      "description": "Add gateway.",
      "run": {
        "method": "PUT",
        "resource": "deploy4.yml",
        "await": [
          "gateways", "gateways:runner", "deployed"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "deploy4.yml",
        "await": [
          "gateways", "gateways:runner", "undeployed"
        ]
      }
    },
    {
      "description": "Send requests to gateway and validate response - 40% / 60%.",
      "run": {
        "method": "PUT",
        "resource": "workflow.yml",
        "await": [
          "workflows:runner-requester", "response:ok"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "workflow.yml",
        "await": [
          "workflows:runner-requester", "unscheduled"
        ]
      }
    }
  ]
}
