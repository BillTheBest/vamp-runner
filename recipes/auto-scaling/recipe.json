{
  "name": "Auto Scaling",
  "description": "Auto scaling number of instances based on application response time.",
  "steps": [
    {
      "description": "Deploy service.",
      "run": {
        "method": "PUT",
        "resource": "deploy.yml",
        "await": [
          "blueprints:runner",
          "deployed"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "undeploy.yml",
        "await": [
          "blueprints:runner",
          "undeployed"
        ]
      }
    },
    {
      "description": "Remove default metrics aggregation workflow.",
      "run": {
        "method": "DELETE",
        "resource": "undeploy.yml",
        "await": [
          "workflows:metrics",
          "persistence:deleted"
        ]
      },
      "cleanup": {
        "method": "PUT",
        "resource": "deploy.yml",
        "await": [
          "workflows:metrics",
          "persistence:created"
        ]
      }
    },
    {
      "description": "Run mock metrics aggregation workflow.",
      "run": {
        "method": "PUT",
        "resource": "deploy.yml",
        "await": [
          "workflows:metrics",
          "persistence:deleted"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "undeploy.yml",
        "await": [
          "workflows:metrics",
          "persistence:created"
        ]
      }
    },
    {
      "description": "Auto scale deployment service based on response time.",
      "run": {
        "method": "PUT",
        "resource": "deploy.yml",
        "await": [
          "workflows:auto-scale",
          "exit"
        ]
      },
      "cleanup": {
        "method": "DELETE",
        "resource": "undeploy.yml",
        "await": [
          "workflows:auto-scale",
          "persistence:deleted"
        ]
      }
    }
  ]
}
